var Shuffle=(()=>{var C=Object.defineProperty;var V=Object.getOwnPropertyDescriptor;var W=Object.getOwnPropertyNames;var U=Object.prototype.hasOwnProperty;var P=(i,t)=>{for(var e in t)C(i,e,{get:t[e],enumerable:!0})},Y=(i,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of W(t))!U.call(i,n)&&n!==e&&C(i,n,{get:()=>t[n],enumerable:!(s=V(t,n))||s.enumerable});return i};var $=i=>Y(C({},"__esModule",{value:!0}),i);var ft={};P(ft,{default:()=>ut});var q=class{handlers;on(i,t,e){let s=this.handlers??(this.handlers={});return(s[i]||(s[i]=[])).push({fn:t,ctx:e}),this}once(i,t,e){let s=this;function n(){s.off(i,n),t.apply(e,arguments)}return n.onceCb=t,this.on(i,n,e)}emit(i,...t){let e=t,s=[...(this.handlers??(this.handlers={}))[i]||[]],n=0,o=s.length;for(;n<o;n+=1)s[n].fn.apply(s[n].ctx,e);return this}off(i,t){let e=this.handlers??(this.handlers={}),s=e[i],n=[];if(s&&t)for(let o=0,r=s.length;o<r;o+=1)s[o].fn!==t&&s[o].fn.onceCb!==t&&n.push(s[o]);return n.length>0?e[i]=n:delete e[i],this}};function k(i,t,e){e||(typeof t=="function"?(e=t,t=null):e=j);let s=i&&i.length;if(!s){e(null,[]);return}let n=!1,o=new Array(s);for(let l=0,u=i.length;l<u;l++)i[l].call(t,r(l));function r(l){return function(g,f){if(!n){if(g){e(g,o),n=!0;return}o[l]=f,--s||e(null,o)}}}}function j(){}function K(i,t){let s=i.map(n=>{let{style:o}=n,r=o.transitionDuration,l=o.transitionDelay;return o.transitionDuration="0ms",o.transitionDelay="0ms",{duration:r,delay:l}});t(),i[0].offsetWidth;for(let n=0;n<i.length;n+=1)i[n].style.transitionDuration=s[n].duration,i[n].style.transitionDelay=s[n].delay}function Q(i){i.length>0&&K(i.map(t=>t.item.element),()=>{for(let t of i)t.item.applyCss(t.styles),t.callback()})}function z(i){return[...new Set(i)]}var G=10,L=null;function F(){if(L!==null)return L;let i=document.body||document.documentElement,t=document.createElement("div");t.style.cssText="width:10px;padding:2px;box-sizing:border-box;",i.append(t);let{width:e}=globalThis.getComputedStyle(t,null);return L=Math.round(c(e))===G,t.remove(),L}var J=0;function c(i){return Number.parseFloat(String(i))||J}function T(i,t,e=globalThis.getComputedStyle(i,null)){let s=c(e[t]);return!F()&&t==="width"?s+=c(e.paddingLeft)+c(e.paddingRight)+c(e.borderLeftWidth)+c(e.borderRightWidth):!F()&&t==="height"&&(s+=c(e.paddingTop)+c(e.paddingBottom)+c(e.borderTopWidth)+c(e.borderBottomWidth)),s}function X(i,t=!1){let e=globalThis.getComputedStyle(i,null),s=T(i,"width",e),n=T(i,"height",e);if(t){let o=T(i,"marginLeft",e),r=T(i,"marginRight",e),l=T(i,"marginTop",e),u=T(i,"marginBottom",e);s+=o+r,n+=l+u}return{width:s,height:n}}var I=class{x;y;constructor(i,t){this.x=c(i),this.y=c(t)}static equals(i,t){return i.x===t.x&&i.y===t.y}},b=class{id;left;top;width;height;constructor(i,t,e,s,n){this.id=n,this.left=i,this.top=t,this.width=e,this.height=s}static intersects(i,t){return i.left<t.left+t.width&&t.left<i.left+i.width&&i.top<t.top+t.height&&t.top<i.top+i.height}},p={BASE:"shuffle",SHUFFLE_ITEM:"shuffle-item",VISIBLE:"shuffle-item--visible",HIDDEN:"shuffle-item--hidden"},O="all",Z="groups",A={ANY:"any",ALL:"all"},_={LAYOUT:"shuffle:layout",REMOVED:"shuffle:removed"},tt={group:O,speed:250,easing:"cubic-bezier(0.4, 0.0, 0.2, 1)",itemSelector:"*",sizer:null,gutterWidth:0,columnWidth:0,delimiter:null,buffer:0,columnThreshold:.01,initialSort:null,staggerAmount:15,staggerAmountMax:150,useTransforms:!0,filterMode:A.ANY,isCentered:!1,isRTL:!1,roundTransforms:!0},N=0,a=class S{id;element;isRTL;isVisible;isHidden;scale=1;point=new I;constructor(t,e){N+=1,this.id=N,this.element=t,this.isRTL=!!e,this.isVisible=!0,this.isHidden=!1}show(){this.isVisible=!0,this.element.classList.remove(p.HIDDEN),this.element.classList.add(p.VISIBLE),this.element.removeAttribute("aria-hidden")}hide(){this.isVisible=!1,this.element.classList.remove(p.VISIBLE),this.element.classList.add(p.HIDDEN),this.element.setAttribute("aria-hidden","true")}init(){this.addClasses([p.SHUFFLE_ITEM,p.VISIBLE]),this.applyCss(S.Css.INITIAL),this.applyCss(this.isRTL?S.Css.DIRECTION.rtl:S.Css.DIRECTION.ltr),this.scale=S.Scale.VISIBLE,this.point=new I}addClasses(t){for(let e of t)this.element.classList.add(e)}removeClasses(t){for(let e of t)this.element.classList.remove(e)}applyCss(t){for(let[e,s]of Object.entries(t))this.element.style[e]=String(s)}dispose(){this.removeClasses([p.HIDDEN,p.VISIBLE,p.SHUFFLE_ITEM]),this.element.removeAttribute("style"),this.element=null}static Css={INITIAL:{position:"absolute",top:0,visibility:"visible",willChange:"transform"},DIRECTION:{ltr:{left:0},rtl:{right:0}},VISIBLE:{before:{opacity:1,visibility:"visible"},after:{transitionDelay:""}},HIDDEN:{before:{opacity:0},after:{visibility:"hidden",transitionDelay:""}}};static Scale={VISIBLE:1,HIDDEN:.001}};function R({visible:i,hidden:t}){for(let e of i)e.show();for(let e of t)e.hide()}function D(i){for(let t of i)t.init()}function w(i){for(let t of i)t.dispose()}function x(i){i.scale=a.Scale.HIDDEN,i.isHidden=!0,i.applyCss(a.Css.HIDDEN.before),i.applyCss(a.Css.HIDDEN.after)}function et(i){let t=i.length;for(;t;){t-=1;let e=Math.floor(Math.random()*(t+1)),s=i[e];i[e]=i[t],i[t]=s}return i}var st={reverse:!1,by:null,compare:null,randomize:!1,key:"element"};function M(i,t){if(!Array.isArray(i))return[];let e={...st,...t},s=[...i],n=!1;if(i.length===0)return[];if(e.randomize)return et(i);if(typeof e.by=="function"){let o=e.by;i.sort((r,l)=>{if(n)return 0;let u=r[e.key],g=l[e.key],f=o(u),d=o(g);return f===void 0&&d===void 0?(n=!0,0):f<d||f==="sortFirst"||d==="sortLast"?-1:f>d||f==="sortLast"||d==="sortFirst"?1:0})}else typeof e.compare=="function"&&i.sort(e.compare);return n?s:(e.reverse&&i.reverse(),i)}var it=class{#e=new Map;#t=0;#s(){return this.#t+=1,`transitionend${this.#t}`}waitForTransition(i,t){let e=this.#s(),s=n=>{n.currentTarget===n.target&&(this.cancelTransition(e),t(n))};return i.addEventListener("transitionend",s),this.#e.set(e,{element:i,listener:s}),e}cancelTransition(i){let t=this.#e.get(i);return t?(t.element.removeEventListener("transitionend",t.listener),this.#e.delete(i),!0):!1}cancelAll(){for(let i of this.#e.keys())this.cancelTransition(i)}};function nt(){return new it}function ot(i,t,e,s){let n=i/t;return Math.abs(Math.round(n)-n)<s&&(n=Math.round(n)),Math.min(Math.ceil(n),e)}function rt(i,t,e){if(t===1)return i;let s=[];for(let n=0;n<=e-t;n+=1)s.push(Math.max(...i.slice(n,n+t)));return s}function lt(i,t){let e=Math.min(...i);for(let s=0,n=i.length;s<n;s+=1)if(i[s]>=e-t&&i[s]<=e+t)return s;return 0}function ht({itemSize:i,positions:t,gridSize:e,total:s,threshold:n,buffer:o}){let r=ot(i.width,e,s,n),l=rt(t,r,s),u=lt(l,o),g=new I(e*u,l[u]),f=l[u]+i.height;for(let d=0;d<r;d+=1)t[u+d]=f;return g}function at(i,t){let e={};for(let r of i)e[r.top]===void 0?e[r.top]=[r]:e[r.top].push(r);let s=[],n=[],o=[];for(let r of Object.values(e)){n.push(r);let l=r.at(-1),u=l.left+l.width,g=Math.round((t-u)/2),f=r,d=!1;if(g>0){let E=[];d=r.every(m=>{let y=new b(m.left+g,m.top,m.width,m.height,m.id),v=!s.some(B=>b.intersects(y,B));return E.push(y),v}),d&&(f=E)}if(!d){let E;if(r.some(m=>s.some(y=>{let v=b.intersects(m,y);return v&&(E=y),v}))){let m=o.findIndex(y=>y.includes(E));o.splice(m,1,n[m])}}s.push(...f),o.push(f)}return o.flat().toSorted((r,l)=>r.id-l.id).map(r=>new I(r.left,r.top))}var H=0,ut=class h extends q{element;sizer;options;lastSort;group;lastFilter;isEnabled;isDestroyed;isInitialized;isTransitioning;id;items;sortedItems;visibleItems;cols;colWidth;containerWidth;positions;#e;#t;#s;#i=null;constructor(t,e={}){super(),this.options={...h.options,...e},this.lastSort={},this.group=h.ALL_ITEMS,this.lastFilter=h.ALL_ITEMS,this.isEnabled=!0,this.isDestroyed=!1,this.isInitialized=!1,this.#e=nt(),this.isTransitioning=!1,this.#t=[];let s=this.#n(t);if(!s)throw new TypeError("Shuffle needs to be initialized with an element.");if(this.element=s,this.id=`shuffle_${H}`,H+=1,this.items=this.#l(),this.sortedItems=this.items,this.sizer=this.#n(this.options.sizer),this.element.classList.add(h.Classes.BASE),D(this.items),document.readyState!=="complete"){let r=this.layout.bind(this);window.addEventListener("load",function l(){window.removeEventListener("load",l),r()})}let n=globalThis.getComputedStyle(this.element,null),o=h.getSize(this.element).width;this.#y(n),this.#u(o),this.filter(this.options.group,this.options.initialSort),this.#s=null,this.#i=new ResizeObserver(this.#D.bind(this)),this.#i.observe(this.element),this.element.offsetWidth,this.setItemTransitions(this.items),this.element.style.transition=`height ${this.options.speed}ms ${this.options.easing}`,this.isInitialized=!0}on(t,e,s){return super.on(t,e,s)}once(t,e,s){return super.once(t,e,s)}emit(t,e){return this.isDestroyed?this:super.emit(t,e)}off(t,e){return super.off(t,e)}#n(t){return typeof t=="string"?this.element?this.element.querySelector(t):document.querySelector(t):t&&"nodeType"in t&&t.nodeType&&t.nodeType===1?t:t&&"jquery"in t?t[0]:null}#y(t){t.position==="static"&&(this.element.style.position="relative"),t.overflow!=="hidden"&&(this.element.style.overflow="hidden")}#o(t=this.lastFilter,e=this.items){let s=this.#T(t,e);return R(s),this.lastFilter=t,typeof t=="string"&&(this.group=t),s}#T(t,e){let s=[],n=[];if(t===h.ALL_ITEMS)s=e;else for(let o of e)this.#I(t,o.element)?s.push(o):n.push(o);return{visible:s,hidden:n}}#I(t,e){if(typeof t=="function")return t.call(e,e,this);let s=e.dataset[h.FILTER_ATTRIBUTE_KEY]??"",n=this.options.delimiter?s.split(this.options.delimiter):JSON.parse(s);function o(r){return n.includes(r)}return Array.isArray(t)?this.options.filterMode===A.ANY?t.some(o):t.every(o):n.includes(t)}#r(){this.visibleItems=this.#a().length}setItemTransitions(t){let{speed:e,easing:s}=this.options,n=this.options.useTransforms?["transform"]:["top","left"],o=Object.keys(a.Css.HIDDEN.before),r=[...n,...o].join(",");for(let l of t)l.element.style.transitionDuration=`${e}ms`,l.element.style.transitionTimingFunction=s,l.element.style.transitionProperty=r}#l(){return Array.from(this.element.children).filter(t=>t.matches(this.options.itemSelector)).map(t=>new a(t,this.options.isRTL))}#h(t){let e=Array.from(this.element.children);return M([...this.items,...t],{by(s){return e.indexOf(s)}})}#a(){return this.items.filter(t=>t.isVisible)}#E(){return this.items.filter(t=>!t.isVisible)}#S(t,e){let s;return typeof this.options.columnWidth=="function"?s=this.options.columnWidth(t):this.sizer?s=h.getSize(this.sizer).width:this.options.columnWidth?s=this.options.columnWidth:this.items.length>0?s=h.getSize(this.items[0].element,!0).width:s=t,s===0&&(s=t),s+e}#b(t){return typeof this.options.gutterWidth=="function"?this.options.gutterWidth(t):this.sizer?T(this.sizer,"marginLeft"):this.options.gutterWidth?this.options.gutterWidth:0}#u(t=h.getSize(this.element).width){let e=this.#b(t),s=this.#S(t,e),n=(t+e)/s,o=this.options.columnThreshold;Math.abs(Math.round(n)-n)<o&&(n=Math.round(n)),this.cols=Math.max(Math.floor(n||0),1),this.containerWidth=t,this.colWidth=s}#v(){this.element.style.height=`${this.#L()}px`}#L(){return Math.max(...this.positions)}#f(t){return Math.min(t*this.options.staggerAmount,this.options.staggerAmountMax)}#d(){let t=this.cols;for(this.positions=[];t;)t-=1,this.positions.push(0)}#C(t){let e=this.#c(t),s=0;for(let n=0;n<t.length;n+=1){let o=t[n],r=()=>{o.applyCss(a.Css.VISIBLE.after)};if(I.equals(o.point,e[n])&&!o.isHidden){o.applyCss(a.Css.VISIBLE.before),r();continue}o.point=e[n],o.scale=a.Scale.VISIBLE,o.isHidden=!1;let l=this.getStylesForTransition(o,a.Css.VISIBLE.before);l.transitionDelay=`${this.#f(s)}ms`,this.#t.push({item:o,styles:l,callback:r}),s+=1}}#c(t){if(this.options.isCentered){let e=t.map((s,n)=>{let o=h.getSize(s.element,!0),r=this.#m(o);return new b(r.x,r.y,o.width,o.height,n)});return this.getTransformedPositions(e,this.containerWidth)}return t.map(e=>this.#m(h.getSize(e.element,!0)))}#m(t){return ht({itemSize:t,positions:this.positions,gridSize:this.colWidth,total:this.cols,threshold:this.options.columnThreshold,buffer:this.options.buffer})}getTransformedPositions(t,e){return at(t,e)}#p(t=this.#E()){let e=0;for(let s of t){let n=()=>{s.applyCss(a.Css.HIDDEN.after)};if(s.isHidden){s.applyCss(a.Css.HIDDEN.before),n();continue}s.scale=a.Scale.HIDDEN,s.isHidden=!0;let o=this.getStylesForTransition(s,a.Css.HIDDEN.before);o.transitionDelay=`${this.#f(e)}ms`,this.#t.push({item:s,styles:o,callback:n}),e+=1}}#D(t){if(!(!this.isEnabled||this.isDestroyed))for(let e of t)Math.round(e.contentRect.width)!==Math.round(this.containerWidth)&&(cancelAnimationFrame(this.#s),this.#s=requestAnimationFrame(()=>{this.update()}))}getStylesForTransition(t,e){let s={...e};return this.options.useTransforms?s.transform=`translate(${this.options.isRTL?"-":""}${this.options.roundTransforms?Math.round(t.point.x):t.point.x}px, ${this.options.roundTransforms?Math.round(t.point.y):t.point.y}px) scale(${t.scale})`:(this.options.isRTL?s.right=`${t.point.x}px`:s.left=`${t.point.x}px`,s.top=`${t.point.y}px`),s}#w(t,e,s){this.#e.waitForTransition(t,n=>{e(),s(null,n)})}#M(t){return e=>{t.item.applyCss(t.styles),this.#w(t.item.element,t.callback,e)}}#A(){this.isTransitioning&&this.#g();let t=typeof this.options.speed=="number"&&this.options.speed>0,e=this.#t.length>0;e&&t&&this.isInitialized?this.#z(this.#t):e?(Q(this.#t),this.emit(h.EventType.LAYOUT,{type:h.EventType.LAYOUT,shuffle:this})):this.emit(h.EventType.LAYOUT,{type:h.EventType.LAYOUT,shuffle:this}),this.#t.length=0}#z(t){this.isTransitioning=!0,k(t.map(e=>this.#M(e)),this.#F.bind(this))}#g(){this.#e.cancelAll(),this.isTransitioning=!1}#F(){this.isTransitioning=!1,this.emit(h.EventType.LAYOUT,{type:h.EventType.LAYOUT,shuffle:this})}filter(t,e){this.isEnabled&&((!t||t.length===0)&&(t=h.ALL_ITEMS),this.#o(t),this.#p(),this.#r(),this.sort(e))}sort(t=this.lastSort){if(!this.isEnabled)return;this.#d();let e=M(this.#a(),t);this.sortedItems=e,this.#C(e),this.#A(),this.#v(),this.lastSort=t}update({recalculateSizes:t=!0,force:e=!1}={}){(this.isEnabled||e)&&(t&&this.#u(),this.sort())}layout(){this.update({recalculateSizes:!0})}add(t){let e=z(t).map(r=>new a(r,this.options.isRTL));D(e),this.#d();let s=M(this.#h(e),this.lastSort),n=this.#o(this.lastFilter,s),o=this.#c(n.visible);for(let r=0;r<n.visible.length;r+=1){let l=n.visible[r];e.includes(l)&&(l.point=o[r],x(l),l.applyCss(this.getStylesForTransition(l,{})))}for(let r of n.hidden)e.includes(r)&&x(r);this.element.offsetWidth,this.setItemTransitions(e),this.items=this.#h(e),this.filter(this.lastFilter)}disable(){this.isEnabled=!1}enable(t=!0){this.isEnabled=!0,t&&this.update()}remove(t){if(t.length===0)return;let e=z(t),s=e.map(o=>this.getItemByElement(o)).filter(Boolean),n=()=>{w(s);for(let o of e)o.remove();this.emit(h.EventType.REMOVED,{type:h.EventType.REMOVED,shuffle:this,collection:e})};R({visible:[],hidden:s}),this.#p(s),this.sort(),this.items=this.items.filter(o=>!s.includes(o)),this.#r(),this.once(h.EventType.LAYOUT,n)}getItemByElement(t){return this.items.find(e=>e.element===t)}resetItems(){w(this.items),this.isInitialized=!1,this.items=this.#l(),D(this.items),this.once(h.EventType.LAYOUT,()=>{this.setItemTransitions(this.items),this.isInitialized=!0}),this.filter(this.lastFilter)}destroy(){this.#g(),this.#i&&(this.#i.unobserve(this.element),this.#i=null),this.element.classList.remove("shuffle"),this.element.removeAttribute("style"),w(this.items),this.items.length=0,this.sortedItems.length=0,this.sizer=null,this.element=null,this.isDestroyed=!0,this.isEnabled=!1}static getSize=X;static ShuffleItem=a;static ALL_ITEMS=O;static FILTER_ATTRIBUTE_KEY=Z;static EventType=_;static Classes=p;static FilterMode=A;static options=tt;static Point=I;static Rect=b};return $(ft);})();
